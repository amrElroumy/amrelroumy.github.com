
<!DOCTYPE html>
<html lang="en">
    <head>
        
        <title>Strategy Pattern | Amr Elroumy's Blog</title>
        <meta name="description" content="">
        <meta name="author" content="">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
                <!-- <link href="http://fonts.googleapis.com/css?family=Aldrich|Lato:400,400italic" rel="stylesheet" type="text/css"> -->
        <!-- <link href='http://fonts.googleapis.com/css?family=Alfa+Slab+One|PT+Sans' rel='stylesheet' type='text/css'> -->
        
                <link rel="stylesheet" href="/media/css/font-awesome.css">
        <link rel="stylesheet" href="/media/css/bootstrap-responsive.min.css">
        <link rel="stylesheet" href="/media/css/style.css">
        
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

                    
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src= "/media/js/jquery.timeago.min.js"></script>    
    <script type="text/javascript">
        jQuery(document).ready(function() {
            jQuery("time.timeago").timeago();
        });
    </script>

            <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'amrelroumysblog'; // required: replace example with your forum shortname
            
                        
            var disqus_identifier = '06dd1b16-677a-46a3-a7e7-e9222d43b163'; // Unique identifier for each blog post to identify the comment thread
                                                                                                       //   Instead of depending on unreliable post url which could be changed
            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            
                <link rel="shortcut icon" href="/favicon.ico" />
            
            </head>

    <body>

        
        <!-- Blog Continer -->
        <div class="container-fluid">

            <!-- Blog Top Bar -->
                            <div id="topbar">
    <h2 id="topbar-title">
      <a href="/index.html">
          <div class="logo" ></div>
          Amr Elroumy's Blog
      </a>
  </h2>
</div>                        <!-- End Blog Top Bar -->

            <div class="row-fluid">
                <!-- Sidebar Menu -->
                                     <div class="span3" id="sidebar">
    <ul class="sidebar-menu sidebar-nav-fixed">
        <li>
            <div class="sidebar-menu-item-wrapper">
                <a href="/">
                    <i class="icon-home icon-white"></i>
                    <span>Home</span>
                </a>
            </div>
        </li>
        <li>
            <div class="sidebar-menu-item-wrapper">
                <a href="/blog/">
                    <i class="icon-list-alt icon-white"></i>
                    <span>Blog</span>
                </a>
            </div>
        </li>
        <li>
            <div class="sidebar-menu-item-wrapper">
                <a href="/about/">
                    <i class="icon-info-sign icon-white"></i>
                    <span>About Me</span>
                </a>
            </div>
        </li>
    </ul>
</div>                                <!-- End Sidebar Menu -->

                <div class="span9">
                    <div class="content"> 
                            <div class="row-fluid page-header">
        <div class="span9">
            <h1>
                Strategy Pattern
            </h1>
        </div>
        <div class="span3 date"><time class="timeago"
      datetime="2011-07-01T13:23:58Z"
      pubdate>
  <abbr class="published updated" title="2011-07-01T13:23:58Z">July 01, 2011</abbr>
</time>
</div>
    </div>
    <h2>Pattern&nbsp;Name</h2>
<p>Strategy&nbsp;Pattern</p>
<h2>Classification</h2>
<p>Behavioral&nbsp;Pattern</p>
<h2>Intent</h2>
<blockquote>
<p>Define a family of algorithms/behaviors, encapsulate each one and make them interchangeable. The Strategy pattern lets the algorithm vary independently from the clients that use&nbsp;it.</p>
</blockquote>
<h2>Also known&nbsp;as</h2>
<p>Policy&nbsp;pattern</p>
<h2>Motivation</h2>
<p>In some situations, we might find ourselves working with classes that only differ in their behavior. If we use inheritance, weâ€™ll have to override the behavior every time we want to derive a class and want to change the algorithm, but when we want to remove special behaviors we would override them with empty methods because the algorithms are hardwired in the classes. Such rigidity in the implementation breaks an important <span class="caps">OO</span> principle, which is&nbsp;flexibility.</p>
<p>Also another approach would be providing an interface for each algorithm, this way only classes that should have this algorithm can implement it; thus, solving some of the first approach&#8217;s shortcomings. But it will have its own disadvantages like duplicate code . Also, by applying this approach, we can kiss code reuse goodbye since we&#8217;ll have to write the algorithm in each class. Consequently, the slightest change in the implementation will require us to go over all the classes and change them too. These shortcomings would create and ideal &#8220;Maintenance&nbsp;Nightmare&#8221;.</p>
<p><strong>We can conclude some of the restrictions that prevent us from using any of the previously mentioned approaches,&nbsp;include:</strong></p>
<ul>
<li>
<p><strong>Clients vary in complexity</strong>; some can be very simple to the point they are have one behavior only, while others might be complicated to support multiple&nbsp;behaviors.</p>
</li>
<li>
<p>If the algorithms are hardwired in the clients, it will be <strong><em>hard to implement</em></strong> new ones or <strong><em>modify</em></strong> the ones that already&nbsp;exist.</p>
</li>
</ul>
<h2>The design principles behind the&nbsp;pattern</h2>
<ul>
<li>Identify the aspects of our application that might vary and is suspected to change in the future and <strong>separate (encapsulate)</strong> them from the rest of the code. This way when they are changed, the rest of the code won&#8217;t be&nbsp;affected.</li>
<li><strong>Program To an interface not to an implementation</strong>; the idea here is to exploit polymorphism by programming to a supertype so that the actual runtime object isn&#8217;t hardwired into the code. This way, behaviors and clients are loosely coupled and clients can use behaviors&nbsp;interchangeably.</li>
</ul>
<hr>
<h2>Applicability (from GoF&#8217;s&nbsp;book)</h2>
<p><strong>Use the Strategy pattern&nbsp;when:</strong></p>
<ul>
<li>Many related classes differ only in their behavior. Strategies provide a way to configure a class with one of many&nbsp;behaviors.</li>
<li>You need different variants of an algorithm. For example, you might define algorithms reflecting different space/time trade-offs. Strategies can be used when these variants are implemented as a class hierarchy of algorithms&nbsp;[<span class="caps">HO87</span>].</li>
<li>An algorithm uses data that clients shouldn&#8217;t know about. Use the Strategy pattern to avoid exposing complex, algorithm-specific data&nbsp;structures.</li>
<li>A class defines many behaviors, and these appear as multiple conditional statements in its operations. Instead of many conditionals, move related conditional branches into their own Strategy&nbsp;class.</li>
</ul>
<h2>Structure</h2>
<p><img alt="Strategy_Pattern" src="http://amrelroumy.files.wordpress.com/2011/07/strategy_pattern3.png"></p>
<h2>Participants</h2>
<ul>
<li><strong>IStrategy: </strong>The interface common to all algorithms that the client uses to deal with the <strong>Strategies</strong> (Concrete Algorithms). This interface represents the family of <strong>Strategies </strong>that share something in common. This interface can be implemented as an abstract class if it has functionality to provide to its&nbsp;children.</li>
<li><strong>Context/Client: </strong>Uses the interchangeable algorithms through the <strong>IStrategy</strong> interface. It declares a property of the <strong>IStrategy</strong> type that holds one of the <strong>Strategies</strong>. This property can be set to the required algorithm in the&nbsp;runtime.</li>
<li><strong>Strategy A / Strategy B: </strong>They implement the <strong>IStrategy </strong>interface and represent the different implementations of the&nbsp;algorithm.</li>
</ul>
<h2>Consequences</h2>
<p><strong>The strategy design pattern splits the behaviors of a class from the class itself, resulting in the following&nbsp;advantages:</strong></p>
<ul>
<li>The algorithms/behaviors produced are reusable by other clients since they are no longer hardwired in our&nbsp;classes. </li>
<li>Clients can chose from various implementations of the same&nbsp;behavior. </li>
<li>New algorithms/behaviors can be added easily without the need to modify any existing code.<br>
</li>
</ul>
<p><strong>Yet, the strategy design pattern has some draw backs (from GoF&#8217;s&nbsp;book):</strong></p>
<ul>
<li><strong>Clients must be aware of different Strategies</strong>. The pattern has a potential drawback in that a client must understand how Strategies differ before it can select the appropriate one. Clients might be exposed to implementation issues. Therefore you should use the Strategy pattern only when the variation in behavior is relevant to&nbsp;clients.</li>
<li><strong>Communication overhead between Strategy and Context</strong>. The Strategy interface is shared by all ConcreteStrategy classes whether the algorithms they implement are trivial or complex. Hence it&#8217;s likely that some ConcreteStrategies won&#8217;t use all the information passed to them through this interface; simple ConcreteStrategies may use none of it! That means there will be times when the context creates and initializes parameters that never get used. If this is an issue, then you&#8217;ll need tighter coupling between Strategy and&nbsp;Context.</li>
<li><strong>Increased number of objects</strong>. Strategies increase the number of objects in an&nbsp;application.</li>
</ul>
<h2>Implementation</h2>
<p><div class="codebox"><figure class="code"><div class="highlight"><pre><span class="k">public</span> <span class="k">interface</span> <span class="n">IStrategy</span> <br /><span class="p">{</span> <br />    <span class="kt">string</span> <span class="nf">ExecuteAlgorithm</span><span class="p">();</span> <br /><span class="p">}</span> <br />&nbsp;<br /><span class="k">public</span> <span class="k">class</span> <span class="nc">ConcreteStrategyA</span> <span class="p">:</span> <span class="n">IStrategy</span> <br /><span class="p">{</span> <br />    <span class="k">public</span> <span class="kt">string</span> <span class="nf">ExecuteAlgorithm</span><span class="p">()</span> <br />    <span class="p">{</span><br />         <span class="k">return</span> <span class="s">&quot;This is Concrete Strategy A&quot;</span><span class="p">;</span> <br />    <span class="p">}</span> <br /><span class="p">}</span> <br />&nbsp;<br /><span class="k">public</span> <span class="k">class</span> <span class="nc">ConcreteStrategyB</span> <span class="p">:</span> <span class="n">IStrategy</span> <br /><span class="p">{</span> <br />    <span class="k">public</span> <span class="kt">string</span> <span class="nf">ExecuteAlgorithm</span><span class="p">();</span> <br />    <span class="p">{</span> <br />        <span class="k">return</span> <span class="s">&quot;This is Concrete Strategy B&quot;</span><span class="p">;</span> <br />    <span class="p">}</span> <br /><span class="p">}</span> <br />&nbsp;<br /><span class="k">public</span> <span class="k">class</span> <span class="nc">Client</span> <br /><span class="p">{</span> <br />    <span class="k">public</span> <span class="n">IStrategy</span> <span class="n">Strategy</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <br />    <span class="k">public</span> <span class="k">void</span> <span class="nf">CallAlgorithm</span><span class="p">()</span> <br />    <span class="p">{</span> <br />        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">Strategy</span><span class="p">.</span><span class="n">ExecuteAlgorithm</span><span class="p">());</span> <br />    <span class="p">}</span> <br /><span class="p">}</span><br /></pre></div><br /><figcaption>C#</figcaption></figure></div></p>
<h2>Sample&nbsp;Code</h2>
<p>We are writing a game that contains different types of terrains(e.g. Marshes, Dessert, City <span class="amp">&amp;</span> Coasts) and different types of characters (e.g. Warrior, Mage <span class="amp">&amp;</span> Rogue). We want every character to pass the terrain with a relative speed to their type and difficulty of the terrain.<br>
</p>
<p>Weâ€™ll refer to the terrains difficulty with integers to keep things simple. Also, weâ€™ll add algorithms to calculate time taken which take in consideration the distance covered, terrain difficulty and character&nbsp;type.</p>
<h3>Class&nbsp;Diagram</h3>
<p><img alt="Strategy_Pattern_Example" src="http://amrelroumy.files.wordpress.com/2011/07/strategy_pattern_example2.png"></p>
<h3>Timerâ€™s&nbsp;implementations</h3>
<p><div class="codebox"><figure class="code"><div class="highlight"><pre><span class="k">public</span> <span class="k">interface</span> <span class="n">ITimer</span> <br /><span class="p">{</span> <br />    <span class="kt">double</span> <span class="nf">CalculateTimeTaken</span><span class="p">(</span><span class="kt">double</span> <span class="n">distance</span><span class="p">,</span> <span class="kt">int</span> <span class="n">terrainRate</span><span class="p">);</span> <br /><span class="p">}</span> <br />&nbsp;<br /><span class="k">public</span> <span class="k">class</span> <span class="nc">RogueTimer</span><span class="p">:</span> <span class="n">ITimer</span> <br /><span class="p">{</span> <br />    <span class="kt">double</span> <span class="nf">CalculateTimeTaken</span><span class="p">(</span><span class="kt">double</span> <span class="n">distance</span><span class="p">,</span> <span class="kt">int</span> <span class="n">terrainRate</span><span class="p">)</span> <br />    <span class="p">{</span><br />        <span class="kt">double</span> <span class="n">timeTaken</span><span class="p">;</span> <br />        <span class="c1">//Implementation of Timer </span><br />        <span class="k">return</span> <span class="n">timeTaken</span><span class="p">;</span> <br />    <span class="p">}</span> <br /><span class="p">}</span> <br />&nbsp;<br /><span class="k">public</span> <span class="k">class</span> <span class="nc">MageTimer</span><span class="p">:</span> <span class="n">ITimer</span> <br /><span class="p">{</span> <br />    <span class="kt">double</span> <span class="nf">CalculateTimeTaken</span><span class="p">(</span><span class="kt">double</span> <span class="n">distance</span><span class="p">,</span> <span class="kt">int</span> <span class="n">terrainRate</span><span class="p">)</span> <br />    <span class="p">{</span><br />        <span class="kt">double</span> <span class="n">timeTaken</span><span class="p">;</span> <br />        <span class="c1">//Implementation of Timer </span><br />        <span class="k">return</span> <span class="n">timeTaken</span><span class="p">;</span> <br />    <span class="p">}</span> <br /><span class="p">}</span> <br />&nbsp;<br /><span class="k">public</span> <span class="k">class</span> <span class="nc">WarriorTimer</span><span class="p">:</span> <span class="n">ITimer</span> <br /><span class="p">{</span> <br />    <span class="kt">double</span> <span class="nf">CalculateTimeTaken</span><span class="p">(</span><span class="kt">double</span> <span class="n">distance</span><span class="p">,</span> <span class="kt">int</span> <span class="n">terrainRate</span><span class="p">)</span> <br />    <span class="p">{</span> <br />        <span class="kt">double</span> <span class="n">timeTaken</span><span class="p">;</span> <br />        <span class="c1">//Implementation of Timer </span><br />        <span class="k">return</span> <span class="n">timeTaken</span><span class="p">;</span> <br />    <span class="p">}</span> <br /><span class="p">}</span><br /></pre></div><br /><figcaption>C#</figcaption></figure></div></p>
<h3>Charactersâ€™&nbsp;implementations</h3>
<p><div class="codebox"><figure class="code"><div class="highlight"><pre><span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">Character</span> <br /><span class="p">{</span> <br />    <span class="k">public</span> <span class="n">ITimer</span> <span class="n">Timer</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <br />    <span class="k">private</span> <span class="n">Health</span><span class="p">;</span> <span class="k">public</span> <span class="k">abstract</span> <span class="kt">double</span> <span class="n">CalculateTimeTaken</span><span class="p">(</span><span class="kt">double</span> <span class="n">distance</span><span class="p">,</span> <span class="kt">int</span> <span class="n">terrainRate</span><span class="p">);</span> <br /><span class="p">}</span> <br />&nbsp;<br /><span class="k">public</span> <span class="k">class</span> <span class="nc">Warrior</span> <span class="p">:</span> <span class="n">Character</span> <br /><span class="p">{</span> <br />    <span class="k">private</span> <span class="n">Stamina</span><span class="p">;</span> <br />    <span class="k">private</span> <span class="n">Strength</span><span class="p">;</span> <br />    <span class="k">public</span> <span class="nf">Warrior</span><span class="p">()</span> <br />    <span class="p">{</span><br />        <span class="c1">// Constructor code here </span><br />    <span class="p">}</span> <br />    <br />    <span class="k">public</span> <span class="k">override</span> <span class="kt">double</span> <span class="nf">CalculateTimeTaken</span><span class="p">(</span><span class="kt">double</span> <span class="n">distance</span><span class="p">,</span> <span class="kt">int</span> <span class="n">terrainRate</span><span class="p">)</span> <br />    <span class="p">{</span><br />        <span class="k">return</span> <span class="n">Timer</span><span class="p">.</span><span class="n">CalculateTimeTaken</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="n">terrainRate</span><span class="p">);</span> <br />    <span class="p">}</span> <br /><span class="p">}</span> <br />&nbsp;<br /><span class="k">public</span> <span class="k">class</span> <span class="nc">Mage</span> <span class="p">:</span> <span class="n">Character</span> <br /><span class="p">{</span> <br />    <span class="k">private</span> <span class="n">Mana</span><span class="p">;</span>     <br />    <span class="k">private</span> <span class="n">WillPower</span><span class="p">;</span> <br />    <span class="k">public</span> <span class="nf">Mage</span><span class="p">()</span> <br />    <span class="p">{</span><br />         <span class="c1">// Constructor code here </span><br />    <span class="p">}</span> <br />&nbsp;<br />    <span class="k">public</span> <span class="k">override</span> <span class="kt">double</span> <span class="nf">CalculateTimeTaken</span><span class="p">(</span><span class="kt">double</span> <span class="n">distance</span><span class="p">,</span> <span class="kt">int</span> <span class="n">terrainRate</span><span class="p">)</span> <br />    <span class="p">{</span> <br />        <span class="k">return</span> <span class="n">Timer</span><span class="p">.</span><span class="n">CalculateTimeTaken</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="n">terrainRate</span><span class="p">);</span> <br />    <span class="p">}</span> <br /><span class="p">}</span> <br />&nbsp;<br /><span class="k">public</span> <span class="k">class</span> <span class="nc">Rogue</span><span class="p">:</span> <span class="n">Character</span> <br /><span class="p">{</span> <br />    <span class="k">private</span> <span class="n">Dexterity</span><span class="p">;</span> <br />    <span class="k">private</span> <span class="n">Constitution</span><span class="p">;</span> <br />    <span class="k">public</span> <span class="nf">Rogue</span><span class="p">()</span> <br />    <span class="p">{</span><br />         <span class="c1">// Constructor code here </span><br />    <span class="p">}</span> <br />&nbsp;<br />    <span class="k">public</span> <span class="k">override</span> <span class="kt">double</span> <span class="nf">CalculateTimeTaken</span><span class="p">(</span><span class="kt">double</span> <span class="n">distance</span><span class="p">,</span> <span class="kt">int</span> <span class="n">terrainRate</span><span class="p">)</span> <br />    <span class="p">{</span> <br />        <span class="k">return</span> <span class="n">Timer</span><span class="p">.</span><span class="n">CalculateTimeTaken</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="n">terrainRate</span><span class="p">);</span> <br />    <span class="p">}</span> <br /><span class="p">}</span><br /></pre></div><br /><figcaption>C#</figcaption></figure></div></p>
<h3>Testing&nbsp;Code</h3>
<p><div class="codebox"><figure class="code"><div class="highlight"><pre><span class="n">Warrior</span> <span class="n">warrior</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Warrior</span><span class="p">();</span> <br /><span class="n">Mage</span> <span class="n">mage</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Mage</span><span class="p">();</span> <br /><span class="n">Rogue</span> <span class="n">rogue</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Rogue</span><span class="p">();</span> <br />&nbsp;<br /><span class="n">warrior</span><span class="p">.</span><span class="n">Timer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WarriorTimer</span><span class="p">();</span> <br /><span class="n">mage</span><span class="p">.</span><span class="n">Timer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">MageTimer</span><span class="p">();</span> <br /><span class="n">rogue</span><span class="p">.</span><span class="n">Timer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RogueTimer</span><span class="p">();</span> <br />&nbsp;<br /><span class="n">Console</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="s">&quot;Warrior&#39;s Time: &quot;</span><span class="p">);</span> <br /><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">warrior</span><span class="p">.</span><span class="n">CalculateTimeTaken</span><span class="p">(</span><span class="m">50</span><span class="p">,</span> <span class="m">3</span><span class="p">);</span> <br />&nbsp;<br /><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Mage&#39;s Time: &quot;</span><span class="p">);</span> <br /><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">mage</span><span class="p">.</span><span class="n">CalculateTimeTaken</span><span class="p">(</span><span class="m">50</span><span class="p">,</span> <span class="m">3</span><span class="p">);</span> <br />&nbsp;<br /><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Rogue&#39;s Time: &quot;</span><span class="p">);</span> <br /><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">rogue</span><span class="p">.</span><span class="n">CalculateTimeTaken</span><span class="p">(</span><span class="m">50</span><span class="p">,</span> <span class="m">3</span><span class="p">);</span><br /></pre></div><br /><figcaption>C#</figcaption></figure></div></p>
<h2>Related&nbsp;Patterns</h2>
<p>Flyweight&nbsp;Pattern</p>
            <div id="disqussion_thread">
            <h2>Comments</h2>
            <div id="disqus_thread"></div>
        </div>
                       </div>
                </div>
            </div>

                        <div class="row-fluid">
                <div class="span12 site-footer">
                    Â©2011-2012 <a href="/about">Amr Ahmed Elroumy</a> <br />Powered by <a href="https://github.com/hyde/hyde" title="The beast under the hood" target="_blank">Hyde</a>
                </div>
            </div>
            
        </div>
        <!-- End Blog Container -->

        
                    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33968631-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>            </body>
</html>